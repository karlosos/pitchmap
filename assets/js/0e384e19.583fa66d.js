(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[671],{426:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return s},metadata:function(){return r},toc:function(){return c},default:function(){return m}});var i=a(2122),n=a(9756),o=(a(7294),a(3905)),s={id:"intro",title:"Introduction",sidebar_position:1},r={unversionedId:"intro",id:"intro",isDocsHomePage:!1,title:"Introduction \u26a1",description:"This is a research project of tracking football players on the playfield captured by a moving camera. Main objective of automatic camera calibration was achieved with available solutions (libraries and other projects).",source:"@site/docs/intro.md",sourceDirName:".",slug:"/intro",permalink:"/pitchmap/docs/intro",editUrl:"https://github.com/karlosos/pitchmap/edit/master/website/docs/intro.md",version:"current",sidebarPosition:1,frontMatter:{id:"intro",title:"Introduction",sidebar_position:1},sidebar:"tutorialSidebar",next:{title:"Demos \ud83d\udda5\ufe0f",permalink:"/pitchmap/docs/demos"}},c=[{value:"Automatic calibration",id:"automatic-calibration",children:[]},{value:"Camera movement analysis",id:"camera-movement-analysis",children:[]},{value:"Players detection",id:"players-detection",children:[]}],l={toc:c};function m(e){var t=e.components,s=(0,n.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,i.Z)({},l,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This is a research project of tracking football players on the playfield captured by a moving camera. Main objective of ",(0,o.kt)("strong",{parentName:"p"},"automatic camera calibration")," was achieved with available solutions (libraries and other projects)."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"../static/img/screen_1.png",src:a(1269).Z})),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This project is research only proof of concept.",(0,o.kt)("br",null),"\nWe do not suggest trying to use this code as it is poorly mantained."))),(0,o.kt)("h2",{id:"automatic-calibration"},"Automatic calibration"),(0,o.kt)("p",null,"Automatic camera calibration module was developed using ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/qubvel/segmentation_models"},"Segmentation Models")," based on ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/DonsetPG/narya"},"DonsetPG/narya"),". It uses ",(0,o.kt)("em",{parentName:"p"},"EfficentNetb3")," and ",(0,o.kt)("em",{parentName:"p"},"FeautrePyramidNetwork"),". ",(0,o.kt)("strong",{parentName:"p"},"Notebooks and scripts of camera calibration model are available in ",(0,o.kt)("a",{parentName:"strong",href:"https://github.com/karlosos/camera_calib"},"karlosos/camera_calib")," repository.")),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you are interested about sports camera calibration we can recommend ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/cemunds/awesome-sports-camera-calibration"},"Awesome Sports Camera Calibration")," on GitHub."))),(0,o.kt)("p",null,"Training data was acquired using ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kkoripl/NaryaKeyPointsDatasetCreator"},"kkoripl/NaryaKeyPointsDatasetCreator"),". We've collected 427 training images from 7 matches played on 3 stadiums."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Described model cannot succesfully detect homography in middle sections of the pitch. This is because of not enough characteristic points in this area. That's why ",(0,o.kt)("strong",{parentName:"p"},"camera movement analysis")," is required for calibrating all frames in input videos."))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Deep neural network model",src:a(2678).Z})),(0,o.kt)("h2",{id:"camera-movement-analysis"},"Camera movement analysis"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Camera movement analysis is required step for finding homography for each frame in input video.")," Camera movement modeling was done using dense optical flow which is calculated on the startup of the application."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Camera movement",src:a(422).Z})),(0,o.kt)("p",null,"With camera movement model we can better interpolate homographies in comparison to naive approach of linear interpolation between calibrated frames in time. ",(0,o.kt)("strong",{parentName:"p"},"Interpolation is performed in camera angle domain"),"."),(0,o.kt)("p",null,"Optical flow is calculated only for non pitch area which is found using color ranges."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Segmentation",src:a(4107).Z})),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"We calculate optical flow only for non pitch area by color ranges. Because of that our system cannot be used in situations where non pitch area is not distinguished by color, e.g. futsal, on stadiums without stands, etc."))),(0,o.kt)("h2",{id:"players-detection"},"Players detection"),(0,o.kt)("p",null,"Players detection is achieved with Yolo model available in ",(0,o.kt)("a",{parentName:"p",href:"https://www.cvlib.net/"},"cvlib"),". We only use objects with ",(0,o.kt)("inlineCode",{parentName:"p"},"person")," label."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Detection",src:a(3416).Z})),(0,o.kt)("p",null,"Each player is classified into 5 classes: team A, team B, goalkeepers and a referee using HSV histograms. Each player is horizontaly divided into halves. Upper halve represents color of the t-shirt, lower halve represents color of the shorts. "),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Classification 1",src:a(6006).Z}),"\n",(0,o.kt)("img",{alt:"Classification 2",src:a(1382).Z})),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Identification",src:a(6081).Z})))}m.isMDXComponent=!0},422:function(e,t,a){"use strict";t.Z=a.p+"assets/images/camera_movement-e6ec3cfd6d33a7548d1072ccbeeacb3f.png"},6006:function(e,t,a){"use strict";t.Z=a.p+"assets/images/classification_1_eng-433c4bf23222edbec664a7eec352f2d3.png"},1382:function(e,t,a){"use strict";t.Z=a.p+"assets/images/classification_2_eng-d847d8fac77363b89dd01645621bd6ba.png"},3416:function(e,t,a){"use strict";t.Z=a.p+"assets/images/detection-9bedbe8d5681b58e566eed3872b709f4.png"},2678:function(e,t,a){"use strict";t.Z=a.p+"assets/images/dnn_pitchmap-644550414c2d143efb00fc6792110c11.png"},6081:function(e,t,a){"use strict";t.Z=a.p+"assets/images/identification-88a29452f8905e88a19b9e76259c7e4a.png"},1269:function(e,t,a){"use strict";t.Z=a.p+"assets/images/screen_1-43fc29df4520ca00f15db2c4637970f2.png"},4107:function(e,t,a){"use strict";t.Z=a.p+"assets/images/segmentation-dac1837ccb01b70d2ca9343e9c022f54.png"}}]);